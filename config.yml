# ConceptBasedPipeline ä¸»é…ç½®æ–‡ä»¶
# =====================================

# OpenAI è®¾ç½®
openai:
  api_key: "sk-zk2884399e3bbb43b998bd31be7b517f82f67bb0e95df2a1"
  model: "gpt-4o-mini"
  embedding_model: "text-embedding-ada-002"
  temperature: 0.1
  base_url: "https://api.zhizengzeng.com/v1/"

# å‘é‡æ•°æ®åº“è®¾ç½®
vector_store:
  # å‘é‡æ•°æ®åº“ç±»å‹: chroma | simple | faiss
  type: "chroma"
  # æœ¬åœ°å­˜å‚¨è·¯å¾„
  persist_directory: "./vector_db"
  # é›†åˆåç§°
  collection_name: "concept_pipeline"
  # å‘é‡ç»´åº¦ (OpenAI text-embedding-ada-002 æ˜¯ 1536)
  dimension: 1536
  # æ˜¯å¦å¯ç”¨embeddingç¼“å­˜
  enable_embedding_cache: true
  # embeddingç¼“å­˜ç›®å½•
  embedding_cache_dir: "./embedding_cache"
  # ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆå¤©ï¼‰
  cache_expiry_days: 30

# é—®ç­”ç”Ÿæˆè®¾ç½®
qa_generation:
  questions_per_type:
    remember: 2
    understand: 2
    apply: 1
    analyze: 1
    evaluate: 1
    create: 1

# è¯­ä¹‰åˆ†å—è®¾ç½®
semantic_chunking:
  buffer_size: 1
  breakpoint_percentile_threshold: 95

# æ¦‚å¿µæå–è®¾ç½®
concept_extraction:
  concepts_per_chunk: 5

# æ¦‚å¿µåˆå¹¶è®¾ç½®
concept_merging:
  similarity_threshold: 0.7
  max_document_concepts: 10

# æ£€ç´¢è®¾ç½®
retrieval:
  top_k: 5

# Evidence æå–è®¾ç½®
evidence_extraction:
  min_length: 20
  max_length: 200

# è¾“å‡ºè®¾ç½®
output:
  directory: "integrated_output"
  save_intermediate_results: true

# æ—¥å¿—è®¾ç½®
logging:
  level: "INFO"

# æç¤ºè¯æ¨¡æ¿ - ä¸“ä¸šè‹±æ–‡æŠ€æœ¯æ¦‚å¿µæå–ç‰ˆæœ¬
prompts:
  concept_extraction: |
    You are an expert in extracting technical concepts from computer science and AI research papers.
    
    Task: Analyze the following academic text and extract {num_concepts} key technical concepts.
    
    Text:
    {text}
    
    EXTRACTION GUIDELINES:
    
    âœ… GOOD technical concepts (2-6 words each):
    - Architecture terms: "transformer architecture", "encoder-decoder structure", "multi-layer perceptron"
    - Algorithm methods: "multi-head attention", "self-attention mechanism", "positional encoding"
    - Performance concepts: "computational efficiency", "training convergence", "inference speed"
    - Domain terminology: "sequence modeling", "neural machine translation", "language modeling"
    - Technical processes: "gradient descent", "backpropagation algorithm", "attention computation"
    
    âŒ AVOID these (low-quality concepts):
    - Single words: "model", "training", "attention", "network", "performance"
    - Common adjectives: "better", "good", "new", "different", "various"
    - Generic terms: "method", "approach", "technique", "system", "framework"
    - Non-technical words: "paper", "work", "study", "research", "results"
    
    SPECIFIC REQUIREMENTS:
    1. Extract exactly {num_concepts} concepts
    2. Each concept must be 2-6 words long
    3. Focus on technical terminology that would appear in CS/AI papers
    4. Concepts should be specific enough to be useful for technical discussion
    5. Prefer compound technical terms over single words
    
    Return the concepts in JSON format:
    {{"concepts": ["technical concept 1", "technical concept 2", "technical concept 3"]}}

  concept_merging: |
    You are an expert in consolidating related technical concepts from computer science research.
    
    Task: Merge the following similar technical concepts into a single, more comprehensive concept phrase.
    
    Related concepts to merge:
    {concepts}
    
    MERGING GUIDELINES:
    - Create a unified concept that captures the essence of all input concepts
    - Use proper technical terminology (2-6 words)
    - The merged concept should be specific enough to be meaningful
    - Prefer established technical terms when possible
    
    Examples:
    - ["attention mechanism", "self attention", "multi head attention"] â†’ "multi-head attention mechanism"
    - ["encoder layers", "decoder structure", "transformer blocks"] â†’ "transformer architecture"
    - ["training efficiency", "computational cost", "optimization speed"] â†’ "training efficiency optimization"
    
    Return only the merged technical concept phrase (no explanation needed):

  evidence_extraction: |
    You are a technical research analyst specializing in extracting supporting evidence from academic papers.
    
    Task: Extract evidence text that directly supports the given technical concept from the provided source text.
    
    Target concept: {concept}
    
    Source text:
    {text}
    
    EVIDENCE EXTRACTION REQUIREMENTS:
    1. Find 1-3 sentences that directly relate to or explain the concept
    2. Evidence must be technically accurate and specific
    3. Preserve original technical terminology and precise wording
    4. Select complete sentences that provide clear technical details
    5. Evidence should help someone understand what the concept means or how it works
    
    QUALITY CRITERIA:
    âœ… Good evidence contains:
    - Technical explanations or definitions
    - Performance metrics or comparisons
    - Implementation details
    - Mathematical formulations
    - Experimental results related to the concept
    
    âŒ Avoid evidence that is:
    - Too general or vague
    - Incomplete sentences
    - References to other papers without context
    - Non-technical background information
    
    Return the evidence in JSON format:
    {{"evidence": ["evidence sentence 1", "evidence sentence 2"]}}

  qa_generation_system: |
    You are an expert educator specializing in creating high-quality questions about technical concepts in computer science and artificial intelligence.
    
    Your questions should help students understand and apply technical knowledge at different cognitive levels following Bloom's Taxonomy.

  qa_generation_user: |
    Based on the following technical evidence text, generate {questions_per_type} high-quality questions for each cognitive level.
    
    Evidence text:
    {evidence_text}
    
    Generate questions following these specifications:
    
    REMEMBER level (factual recall):
    - What specific technical terms or components are mentioned?
    - What are the key definitions or facts presented?
    
    UNDERSTAND level (comprehension):
    - How do the technical concepts work or function?
    - What are the relationships between different components?
    
    APPLY level (application):
    - How would you implement or use this technical approach?
    - In what scenarios would this method be most effective?
    
    ANALYZE level (analysis):
    - What are the advantages and disadvantages of this approach?
    - How does this compare to alternative methods?
    
    EVALUATE level (evaluation):
    - What criteria would you use to assess the effectiveness of this approach?
    - What are the limitations or potential improvements?
    
    CREATE level (synthesis):
    - How could you modify or extend this approach for a different problem?
    - What new applications or variations could you design?
    
    ANSWER REQUIREMENTS:
    - Answers should be technically accurate and detailed
    - Include specific examples when possible
    - Reference the evidence text appropriately
    - Use proper technical terminology
    
    Return the questions and answers in JSON format:
    {{
      "remember": [
        {{"question": "...", "answer": "...", "difficulty": "easy"}},
        {{"question": "...", "answer": "...", "difficulty": "easy"}}
      ],
      "understand": [
        {{"question": "...", "answer": "...", "difficulty": "medium"}},
        {{"question": "...", "answer": "...", "difficulty": "medium"}}
      ],
      "apply": [
        {{"question": "...", "answer": "...", "difficulty": "medium"}}
      ],
      "analyze": [
        {{"question": "...", "answer": "...", "difficulty": "hard"}}
      ],
      "evaluate": [
        {{"question": "...", "answer": "...", "difficulty": "hard"}}
      ],
      "create": [
        {{"question": "...", "answer": "...", "difficulty": "hard"}}
      ]
    }}

# é«˜çº§è®¾ç½®ï¼ˆå¯é€‰ï¼‰
advanced:
  # å¹¶å‘è®¾ç½®
  max_concurrent_requests: 5
  request_timeout: 30
  
  # ç¼“å­˜è®¾ç½®
  enable_cache: true
  cache_directory: ".cache"
  
  # å®éªŒæ€§åŠŸèƒ½
  experimental:
    enable_concept_hierarchy: false
    use_multi_stage_evidence: false

# ğŸ†• Chunkingé…ç½® - æ·»åŠ tokené™åˆ¶
chunking:
  # è¯­ä¹‰åˆ†å—å‚æ•°
  buffer_size: 1
  breakpoint_percentile_threshold: 95
  
  # ğŸ”‘ Tokené™åˆ¶ï¼ˆé˜²æ­¢APIé”™è¯¯ï¼‰
  max_tokens_per_chunk: 6000  # embeddingæ¨¡å‹tokené™åˆ¶ï¼Œä¿ç•™ä½™é‡
  max_char_per_chunk: 24000   # å­—ç¬¦æ•°é™åˆ¶ï¼ˆçº¦4:1æ¯”ä¾‹ï¼‰
  
  # åˆ†å‰²ç­–ç•¥
  enable_fallback_splitting: true
  fallback_chunk_overlap: 200
  min_chunk_length: 10        # æœ€å°chunké•¿åº¦ï¼ˆå­—ç¬¦ï¼‰
  
  # å®‰å…¨æ£€æŸ¥
  enable_token_validation: true
  skip_oversized_chunks: false  # false=åˆ†å‰²ï¼Œtrue=è·³è¿‡ 